!function(e){"use strict";var t=function(){this.$body=$("body"),this.$_UPDATE_TO=$("#custom_fields_container"),this.$_EXPORT_TO=$("#custom_fields_json"),this.CURRENT_DATA=Helpers.jsonDecode(this.$_EXPORT_TO.val(),[]),this.CURRENT_DATA&&(this.handleCustomFields(),this.exportData())};t.prototype.handleCustomFields=function(){var e=this,t=0,a={fieldGroup:$("#_render_customfield_field_group_template").html(),globalSkeleton:$("#_render_customfield_global_skeleton_template").html(),text:$("#_render_customfield_text_template").html(),number:$("#_render_customfield_number_template").html(),email:$("#_render_customfield_email_template").html(),password:$("#_render_customfield_password_template").html(),textarea:$("#_render_customfield_textarea_template").html(),checkbox:$("#_render_customfield_checkbox_template").html(),radio:$("#_render_customfield_radio_template").html(),select:$("#_render_customfield_select_template").html(),image:$("#_render_customfield_image_template").html(),file:$("#_render_customfield_file_template").html(),wysiwyg:$("#_render_customfield_wysiswg_template").html(),repeater:$("#_render_customfield_repeater_template").html(),repeaterItem:$("#_render_customfield_repeater_item_template").html(),repeaterFieldLine:$("#_render_customfield_repeater_line_template").html()},i=function(e,t){return WebEd.wysiwyg(e,{toolbar:"basic"}),e},r=function(e,t){e.forEach(function(e,i){var r=a.globalSkeleton;r=r.replace(/__type__/gi,e.type||""),r=r.replace(/__title__/gi,e.title||""),r=r.replace(/__instructions__/gi,e.instructions||"");var n=$(r);n.find(".meta-box-wrap").append(l(e)),n.data("lcf-registered-data",e),t.append(n)})},l=function(e){var r=a[e.type],l=$('<div class="lcf-'+e.type+'-wrapper"></div>');switch(l.data("lcf-registered-data",e),e.type){case"text":case"number":case"email":case"password":r=r.replace(/__placeholderText__/gi,e.options.placeholderText||""),r=r.replace(/__value__/gi,e.value||e.options.defaultValue||"");break;case"textarea":r=r.replace(/__rows__/gi,e.options.rows||3),r=r.replace(/__placeholderText__/gi,e.options.placeholderText||""),r=r.replace(/__value__/gi,e.value||e.options.defaultValue||"");break;case"image":if(r=r.replace(/__value__/gi,e.value||e.options.defaultValue||""),e.value)r=r.replace(/__image__/gi,e.value||e.options.defaultValue||"");else{var c=$(r).find("img").attr("data-default");r=r.replace(/__image__/gi,c||e.options.defaultValue||"")}break;case"file":r=r.replace(/__value__/gi,e.value||e.options.defaultValue||"");break;case"select":var o=$(r),d=s(e.options.selectChoices);return d.forEach(function(e,t){o.append('<option value="'+e[0]+'">'+e[1]+"</option>")}),o.val(array_get(e,"value",e.options.defaultValue)),l.append(o),l;case"checkbox":var p=s(e.options.selectChoices),_=Helpers.jsonDecode(e.value);return p.forEach(function(e,t){var a=r.replace(/__value__/gi,e[0]||"");a=a.replace(/__title__/gi,e[1]||""),a=a.replace(/__checked__/gi,$.inArray(e[0],_)!=-1?"checked":""),l.append($(a))}),l;case"radio":var u=s(e.options.selectChoices),f=!1;return u.forEach(function(a,i){var n=r.replace(/__value__/gi,a[0]||"");n=n.replace(/__id__/gi,e.id+e.slug+t),n=n.replace(/__title__/gi,a[1]||""),n=n.replace(/__checked__/gi,e.value===a[0]?"checked":""),l.append($(n)),e.value===a[0]&&(f=!0)}),f===!1&&l.find("input[type=radio]:first").prop("checked",!0),l;case"repeater":var m=$(r);return m.data("lcf-registered-data",e),m.find("> .repeater-add-new-field").html(e.options.buttonLabel||"Add new item"),m.find("> .sortable-wrapper").sortable(),n(e.items,e.value||[],m.find("> .field-group-items")),m;case"wysiwyg":r=r.replace(/__value__/gi,e.value||"");var v=$(r);return i(v,e.options.wysiwygToolbar||"basic")}return l.append($(r)),l},n=function(e,t,i){return i.data("lcf-registered-data",e),t.forEach(function(t,r){var l=i.find("> .ui-sortable-handle").length+1,n=a.repeaterItem;n=n.replace(/__position__/gi,l);var s=$(n);s.data("lcf-registered-data",e),c(e,t,s.find("> .field-line-wrapper > .field-group")),i.append(s)}),i},c=function(e,i,r){return i.forEach(function(e,i){t++;var n=a.repeaterFieldLine;n=n.replace(/__title__/gi,e.title||""),n=n.replace(/__instructions__/gi,e.instructions||"");var c=$(n);c.data("lcf-registered-data",e),c.find("> .repeater-item-input").append(l(e)),r.append(c)}),r},s=function(e){var t=[];return e.split("\n").forEach(function(e,a){var i=e.split(":");i[0]&&i[1]&&(i[0]=i[0].trim(),i[1]=i[1].trim()),t.push(i)}),t};this.$body.on("click",".remove-field-line",function(e){e.preventDefault();var t=$(this);t.parent().animate({opacity:.1},300,function(){t.parent().remove()})}),this.$body.on("click",".collapse-field-line",function(e){e.preventDefault();var t=$(this);t.toggleClass("collapsed-line")}),this.$body.on("click",".repeater-add-new-field",function(e){e.preventDefault();var a=$.extend(!0,{},$(this).prev(".field-group-items")),i=a.data("lcf-registered-data");t++,n(i,[i],a)}),this.CURRENT_DATA.forEach(function(t,i){var l=a.fieldGroup;l=l.replace(/__title__/gi,t.title||"");var n=$(l);r(t.items,n.find(".meta-boxes-body")),n.data("lcf-field-group",t),e.$_UPDATE_TO.append(n)})},t.prototype.exportData=function(){var e=this,t=function(){var e=[];return $("#custom_fields_container").find("> .meta-boxes").each(function(){var t=$(this),i=t.data("lcf-field-group"),r=t.find("> .meta-boxes-body > .meta-box");i.items=a(r),e.push(i)}),e},a=function(e){var t=[];return e.each(function(){t.push(i($(this)))}),t},i=function(e){var t=$.extend(!0,{},e.data("lcf-registered-data"));switch(t.type){case"text":case"number":case"email":case"password":case"image":case"file":t.value=e.find("> .meta-box-wrap input").val();break;case"wysiwyg":case"textarea":t.value=e.find("> .meta-box-wrap textarea").val();break;case"checkbox":t.value=[],e.find("> .meta-box-wrap input:checked").each(function(){t.value.push($(this).val())});break;case"radio":t.value=e.find("> .meta-box-wrap input:checked").val();break;case"select":t.value=e.find("> .meta-box-wrap select").val();break;case"repeater":t.value=[];var a=e.find("> .meta-box-wrap > .lcf-repeater > .field-group-items > li");a.each(function(){var e=$(this),a=e.find("> .field-line-wrapper > .field-group");t.value.push(r(a.find("> li")))});break;default:t=null}return t},r=function(e){var t=[];return e.each(function(){var e=$(this);t.push(l(e))}),t},l=function(e){var t=$.extend(!0,{},e.data("lcf-registered-data"));switch(t.type){case"text":case"number":case"email":case"password":case"image":case"file":t.value=e.find("> .repeater-item-input input").val();break;case"wysiwyg":case"textarea":t.value=e.find("> .repeater-item-input textarea").val();break;case"checkbox":t.value=[],e.find("> .repeater-item-input input:checked").each(function(){t.value.push($(this).val())});break;case"radio":t.value=e.find("> .repeater-item-input input:checked").val();break;case"select":t.value=e.find("> .repeater-item-input select").val();break;case"repeater":t.value=[];var a=e.find("> .repeater-item-input > .lcf-repeater > .field-group-items > li");a.each(function(){var e=$(this),a=e.find("> .field-line-wrapper > .field-group");t.value.push(r(a.find("> li")))});break;default:t=null}return t};e.$_EXPORT_TO.closest("form").on("submit",function(a){e.$_EXPORT_TO.val(JSON.stringify(t()))})},function(e){e(document).ready(function(){new t})}(jQuery)}(this.LaravelElixirBundle=this.LaravelElixirBundle||{});
//# sourceMappingURL=use-custom-fields.js.map
