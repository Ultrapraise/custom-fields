!function(e){"use strict";var t=function(){this.$body=$("body"),this.$_UPDATE_TO=$("#custom_fields_container"),this.$_EXPORT_TO=$("#custom_fields_json"),this.CURRENT_DATA=Helpers.jsonDecode(this.$_EXPORT_TO.val(),[]),this.CURRENT_DATA&&(this.handleCustomFields(),this.exportData())};t.prototype.handleCustomFields=function(){var e=this,t=0,a={fieldGroup:$("#_render_customfield_field_group_template").html(),globalSkeleton:$("#_render_customfield_global_skeleton_template").html(),text:$("#_render_customfield_text_template").html(),number:$("#_render_customfield_number_template").html(),email:$("#_render_customfield_email_template").html(),password:$("#_render_customfield_password_template").html(),textarea:$("#_render_customfield_textarea_template").html(),checkbox:$("#_render_customfield_checkbox_template").html(),radio:$("#_render_customfield_radio_template").html(),select:$("#_render_customfield_select_template").html(),image:$("#_render_customfield_image_template").html(),file:$("#_render_customfield_file_template").html(),wysiwyg:$("#_render_customfield_wysiswg_template").html(),repeater:$("#_render_customfield_repeater_template").html(),repeaterItem:$("#_render_customfield_repeater_item_template").html(),repeaterFieldLine:$("#_render_customfield_repeater_line_template").html()},r=function(e,t){var a="basic"===t?{toolbar:[["mode","Source","Image","TextColor","BGColor","Styles","Format","Font","FontSize","CreateDiv","PageBreak","Bold","Italic","Underline","Strike","Subscript","Superscript","RemoveFormat"]]}:{};return e.ckeditor(a),e},i=function(e,t){e.forEach(function(e,r){var i=a.globalSkeleton;i=i.replace(/__type__/gi,e.type||""),i=i.replace(/__title__/gi,e.title||""),i=i.replace(/__instructions__/gi,e.instructions||"");var n=$(i);n.find(".meta-box-wrap").append(l(e)),n.data("lcf-registered-data",e),t.append(n)})},l=function(e){var i=a[e.type],l=$('<div class="lcf-'+e.type+'-wrapper"></div>');switch(l.data("lcf-registered-data",e),e.type){case"text":case"number":case"email":case"password":i=i.replace(/__placeholderText__/gi,e.options.placeholderText||""),i=i.replace(/__value__/gi,e.value||e.options.defaultValue||"");break;case"textarea":i=i.replace(/__rows__/gi,e.options.rows||3),i=i.replace(/__placeholderText__/gi,e.options.placeholderText||""),i=i.replace(/__value__/gi,e.value||e.options.defaultValue||"");break;case"image":if(i=i.replace(/__value__/gi,e.value||e.options.defaultValue||""),e.value)i=i.replace(/__image__/gi,e.value||e.options.defaultValue||"");else{var c=$(i).find("img").attr("data-default");i=i.replace(/__image__/gi,c||e.options.defaultValue||"")}break;case"file":i=i.replace(/__value__/gi,e.value||e.options.defaultValue||"");break;case"select":var s=$(i),d=o(e.options.selectChoices);return d.forEach(function(e,t){s.append('<option value="'+e[0]+'">'+e[1]+"</option>")}),s.val(array_get(e,"value",e.options.defaultValue)),l.append(s),l;case"checkbox":var p=o(e.options.selectChoices),u=Helpers.jsonDecode(e.value);return p.forEach(function(e,t){var a=i.replace(/__value__/gi,e[0]||"");a=a.replace(/__title__/gi,e[1]||""),a=a.replace(/__checked__/gi,$.inArray(e[0],u)!=-1?"checked":""),l.append($(a))}),l;case"radio":var _=o(e.options.selectChoices),f=!1;return _.forEach(function(a,r){var n=i.replace(/__value__/gi,a[0]||"");n=n.replace(/__id__/gi,e.id+e.slug+t),n=n.replace(/__title__/gi,a[1]||""),n=n.replace(/__checked__/gi,e.value===a[0]?"checked":""),l.append($(n)),e.value===a[0]&&(f=!0)}),f===!1&&l.find("input[type=radio]:first").prop("checked",!0),l;case"repeater":var m=$(i);return m.data("lcf-registered-data",e),m.find("> .repeater-add-new-field").html(e.options.buttonLabel||"Add new item"),m.find("> .sortable-wrapper").sortable(),n(e.items,e.value||[],m.find("> .field-group-items")),m;case"wysiwyg":i=i.replace(/__value__/gi,e.value||"");var v=$(i);return r(v,e.options.wysiwygToolbar||"basic")}return l.append($(i)),l},n=function(e,t,r){return r.data("lcf-registered-data",e),t.forEach(function(t,i){var l=r.find("> .ui-sortable-handle").length+1,n=a.repeaterItem;n=n.replace(/__position__/gi,l);var o=$(n);o.data("lcf-registered-data",e),c(e,t,o.find("> .field-line-wrapper > .field-group")),r.append(o)}),r},c=function(e,r,i){return r.forEach(function(e,r){t++;var n=a.repeaterFieldLine;n=n.replace(/__title__/gi,e.title||""),n=n.replace(/__instructions__/gi,e.instructions||"");var c=$(n);c.data("lcf-registered-data",e),c.find("> .repeater-item-input").append(l(e)),i.append(c)}),i},o=function(e){var t=[];return e.split("\n").forEach(function(e,a){var r=e.split(":");r[0]&&r[1]&&(r[0]=r[0].trim(),r[1]=r[1].trim()),t.push(r)}),t};this.$body.on("click",".remove-field-line",function(e){e.preventDefault();var t=$(this);t.parent().animate({opacity:.1},300,function(){t.parent().remove()})}),this.$body.on("click",".collapse-field-line",function(e){e.preventDefault();var t=$(this);t.toggleClass("collapsed-line")}),this.$body.on("click",".repeater-add-new-field",function(e){e.preventDefault();var a=$.extend(!0,{},$(this).prev(".field-group-items")),r=a.data("lcf-registered-data");t++,n(r,[r],a)}),this.CURRENT_DATA.forEach(function(t,r){var l=a.fieldGroup;l=l.replace(/__title__/gi,t.title||"");var n=$(l);i(t.items,n.find(".meta-boxes-body")),n.data("lcf-field-group",t),e.$_UPDATE_TO.append(n)})},t.prototype.exportData=function(){var e=this,t=function(){var e=[];return $("#custom_fields_container").find("> .meta-boxes").each(function(){var t=$(this),r=t.data("lcf-field-group"),i=t.find("> .meta-boxes-body > .meta-box");r.items=a(i),e.push(r)}),e},a=function(e){var t=[];return e.each(function(){t.push(r($(this)))}),t},r=function(e){var t=$.extend(!0,{},e.data("lcf-registered-data"));switch(t.type){case"text":case"number":case"email":case"password":case"image":case"file":t.value=e.find("> .meta-box-wrap input").val();break;case"wysiwyg":case"textarea":t.value=e.find("> .meta-box-wrap textarea").val();break;case"checkbox":t.value=[],e.find("> .meta-box-wrap input:checked").each(function(){t.value.push($(this).val())});break;case"radio":t.value=e.find("> .meta-box-wrap input:checked").val();break;case"select":t.value=e.find("> .meta-box-wrap select").val();break;case"repeater":t.value=[];var a=e.find("> .meta-box-wrap > .lcf-repeater > .field-group-items > li");a.each(function(){var e=$(this),a=e.find("> .field-line-wrapper > .field-group");t.value.push(i(a.find("> li")))});break;default:t=null}return t},i=function(e){var t=[];return e.each(function(){var e=$(this);t.push(l(e))}),t},l=function(e){var t=$.extend(!0,{},e.data("lcf-registered-data"));switch(t.type){case"text":case"number":case"email":case"password":case"image":case"file":t.value=e.find("> .repeater-item-input input").val();break;case"wysiwyg":case"textarea":t.value=e.find("> .repeater-item-input textarea").val();break;case"checkbox":t.value=[],e.find("> .repeater-item-input input:checked").each(function(){t.value.push($(this).val())});break;case"radio":t.value=e.find("> .repeater-item-input input:checked").val();break;case"select":t.value=e.find("> .repeater-item-input select").val();break;case"repeater":t.value=[];var a=e.find("> .repeater-item-input > .lcf-repeater > .field-group-items > li");a.each(function(){var e=$(this),a=e.find("> .field-line-wrapper > .field-group");t.value.push(i(a.find("> li")))});break;default:t=null}return t};e.$_EXPORT_TO.closest("form").on("submit",function(a){e.$_EXPORT_TO.val(JSON.stringify(t()))})},function(e){e(document).ready(function(){new t})}(jQuery)}(this.LaravelElixirBundle=this.LaravelElixirBundle||{});
//# sourceMappingURL=use-custom-fields.js.map
